要**技术层面、可复现、可自动化**地判断一个域名是否被墙（域名解析被污染、IP被封、SNI 层被拦截…），其实可以拆成几个“检测维度”。下面我给你一个**专业工程师视角的完整诊断流程**，你可以本地跑、也可以写成脚本自动执行。

---

# 一、域名是否被墙，其实分 4 种情况

1. **DNS 污染：域名解析结果被劫持**
2. **IP 封锁：解析正常，但 IP 被阻断**
3. **SNI/HTTPS 特征拦截：TCP 能连上，但 TLS 会被重置**
4. **HTTP 层关键字过滤：能连通，但访问 URL 触发封锁**

不同封锁方式→对应不同检测技术。

---

# 二、最可靠的技术检测方法（工程师版）

## **方法 1：多源 DNS 对比（判断是否 DNS 污染）**

**思路：**比对多个区域的 DNS 解析结果，只要中国大陆的解析结果与海外结果不一致，就说明可能污染。

可对比这些 DNS：

* **本地 ISP（电信/联通/移动）**
* **公共 DNS：8.8.8.8（海外）、1.1.1.1、9.9.9.9**
* **DoH/DoT DNS：Cloudflare、Google、Quad9**
* **海外 VPS 上 dig 结果**

示例命令：

```
dig example.com @8.8.8.8
dig example.com @223.5.5.5
dig example.com @114.114.114.114
```

**判断依据：**

* 海外 DNS：1.2.3.4
* 国内 DNS：203.98.x.x（明显错误 IP）
  → **基本确定被 DNS 污染**。

---

## **方法 2：TCP 层连通性测试（判断 IP 是否被封）**

使用 **TCP handshake** 测试最可靠。

命令：

```
curl -v http://1.2.3.4 --connect-timeout 5
telnet 1.2.3.4 80
nc -vz 1.2.3.4 80
```

**判断逻辑：**

* 若无法建立 TCP 连接 → IP 被封
* 若能连但 TLS 会 RST → SNI 被拦截
* 若连得上但无返回 → HTTP 层或其他策略

---

## **方法 3：SNI 探测（判断 HTTPS 是否被拦截）**

这是现代封锁常见方式，尤其对未备案/敏感域名。

使用 openssl：

```
openssl s_client -connect example.com:443 -servername example.com
```

**现象：**

* 一连接就收到 `RST` → SNI 被墙
* 不加 `-servername` 能连，加了就断 → 更能说明 SNI 过滤

---

## **方法 4：与海外节点对比访问（自动化最稳妥）**

准备一个 **海外 VPS** 或使用线上 API（如 cloudflare worker）。

检测方式：

1. 海外访问目标域名 → 是否正常？
2. 大陆本地访问 → 是否失败？

如果海外正常、本地不通 → 99% 确定被墙。

---

## **方法 5：Tracert / MTR 路由诊断（查看中间是否丢包）**

路由被中断通常是 IP 层封锁。

```
mtr -rw example.com
```

* 若在大陆出口节点直接丢包 → 大概率墙层封锁
* 若能到达海外，但网站不通 → 网站配置自身问题

---

## **方法 6：利用 CDN + 源站对照检查（更精确）**

如果网站同时有：

* CDN 访问不受影响
* 直连源站失败

说明源站所在 IP 被封。

---

# 三、推荐的自动化检测脚本（简易版思路）

可以写个脚本（Python/Go 最方便）实现：

**检测流程：**

1. 本地 DNS 解析 → 记录结果
2. 多个海外 DNS → 比对
3. 对每个解析结果逐一进行：

   * `tcp connect`
   * `openssl s_client`
   * `curl -I`
4. 海外 VPS 执行同样测试
5. 根据差异输出封锁类型

**这是工程上对域名状态最严谨的检测方式。**
